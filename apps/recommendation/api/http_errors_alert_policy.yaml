{
    "displayName": "HTTP error count exceeds 1 percent for recommendation API",
    "combiner": "OR",
    "conditions": [
        {
            "displayName": "Ratio: HTTP 500s error-response counts / All HTTP response counts",
            "conditionThreshold": {
                 "filter": "metric.label.response_code_class=\"5xx\" AND
                            metric.type=\"run.googleapis.com/request_count\" AND
                            project=\"passculture-data-prod\" AND
                            resource.type=\"cloud_run_revision\"",
                 "aggregations": [
                    {
                        "alignmentPeriod": "600s",
                        "crossSeriesReducer": "REDUCE_SUM",
                        "groupByFields": [
                          "resource.label.version_id"
                        ],
                        "perSeriesAligner": "ALIGN_DELTA"
                    }
                ],
                "denominatorFilter": "metric.type=\"run.googleapis.com/request_count\" AND
                                      project=\"passculture-data-prod\" AND
                                      resource.type=\"cloud_run_revision\"",
                "denominatorAggregations": [
                   {
                      "alignmentPeriod": "600s",
                      "crossSeriesReducer": "REDUCE_SUM",
                      "groupByFields": [
                        "resource.label.version_id"
                       ],
                      "perSeriesAligner": "ALIGN_DELTA",
                    }
                ],
                "comparison": "COMPARISON_GT",
                "thresholdValue": 0.01,
                "duration": "0s",
                "trigger": {
                    "count": 1
                }
            }
        }
    ]
}
