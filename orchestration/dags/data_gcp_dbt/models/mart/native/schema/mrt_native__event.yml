version: 2

models:
  - name: mrt_native__event
    columns:
      - name: event_name
        data_tests:
          - not_null:
              where: "event_date >= DATE_SUB(CURRENT_DATE(), INTERVAL 1 DAY)"
      - name: user_pseudo_id
        data_tests:
          - not_null:
              where: "event_date >= DATE_SUB(CURRENT_DATE(), INTERVAL 1 DAY)"
      - name: booking_id
        data_tests:
          - relationships:
              to: ref("int_global__booking")
              field: booking_id
              where: "event_date >= DATE_SUB(CURRENT_DATE(), INTERVAL 1 DAY)"
